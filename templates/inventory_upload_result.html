{% extends "base.html" %}
{% block title %}Store · Inventory Upload Result{% endblock %}
{% block content %}
<div class="px-6 py-6 space-y-6 overflow-y-auto h-full">
  <div class="flex items-center justify-between gap-4">
    <div>
      <p class="text-sm uppercase text-slate-500">Store</p>
      <h1 class="text-2xl font-semibold">Inventory upload summary</h1>
      <p class="text-sm text-slate-600">Review the results of the Odoo inventory baseline import.</p>
    </div>
    <a href="{{ url_for('store_inventory') }}" class="inline-flex items-center gap-2 px-4 py-2 bg-slate-900 text-white rounded-xl shadow hover:shadow-lg hover:scale-[1.02] transition">
      ← Back to Inventory
    </a>
  </div>

  {% if fatal_error %}
  <div class="rounded-2xl border border-red-200 bg-red-50 p-5 text-red-700">
    <p class="font-semibold">We couldn't process the upload.</p>
    <p class="text-sm mt-1">{{ fatal_error }}</p>
  </div>
  {% else %}
  <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <p class="text-xs uppercase text-slate-500">Rows processed</p>
      <p class="text-3xl font-semibold text-slate-900">{{ processed_rows }}</p>
    </div>
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <p class="text-xs uppercase text-slate-500">Rows imported</p>
      <p class="text-3xl font-semibold text-emerald-600">{{ imported_rows }}</p>
    </div>
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <p class="text-xs uppercase text-slate-500">Rows skipped</p>
      <p class="text-3xl font-semibold text-amber-600">{{ rows_skipped }}</p>
    </div>
    <div class="rounded-2xl border border-slate-200 bg-white p-5 shadow-sm">
      <p class="text-xs uppercase text-slate-500">Total errors</p>
      <p class="text-3xl font-semibold text-blue-600">{{ total_errors }}</p>
    </div>
  </div>
  {% endif %}

  {% if missing_products %}
  <div class="rounded-2xl border border-blue-200 bg-blue-50 p-5 text-blue-800">
    <div class="flex items-center justify-between gap-3 mb-2">
      <div>
        <p class="text-xs uppercase tracking-wide">Products Missing in Parts — Not Uploaded</p>
        <p class="text-sm text-blue-700">Inventory lines were skipped because the product is not in the Parts master.</p>
      </div>
      <span class="inline-flex items-center justify-center rounded-full bg-blue-600 text-white text-xs w-8 h-8 font-semibold">{{ missing_products|length }}</span>
    </div>
    <ul class="list-disc pl-6 space-y-1 text-sm">
      {% for message in missing_products %}
      <li>{{ message }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}

  {% if row_errors %}
  <div class="rounded-2xl border border-amber-200 bg-amber-50 p-5 text-amber-800">
    <div class="flex items-center justify-between gap-3 mb-2">
      <div>
        <p class="text-xs uppercase tracking-wide">Row issues</p>
        <p class="text-sm text-amber-700">Fix these rows and try uploading again.</p>
      </div>
      <span class="inline-flex items-center justify-center rounded-full bg-amber-600 text-slate-900 text-xs w-8 h-8 font-semibold">{{ row_errors|length }}</span>
    </div>
    <ul class="list-disc pl-6 space-y-1 text-sm">
      {% for error in row_errors %}
      <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
</div>
{% endblock %}

{% extends "base.html" %}
{% block title %}Contract Preview · Eleva ERP{% endblock %}
{% block content %}
<style>
  @media print {
    .contract-header { position: fixed; top: 0; left: 0; right: 0; }
    .contract-footer { position: fixed; bottom: 0; left: 0; right: 0; }
    .contract-body { margin-top: 120px; margin-bottom: 120px; }
  }
</style>
<div class="space-y-4">
  <div class="flex items-center justify-between">
    <h1 class="text-2xl font-semibold text-theme-primary">Contract Preview #{{ contract.id }}</h1>
    <div class="flex gap-2">
      <a href="{{ url_for('service_contract_edit', contract_id=contract.id) }}" class="rounded-xl border border-slate-700 px-3 py-2 text-xs text-slate-300">Edit</a>
      <a href="{{ url_for('service_contract_pdf', contract_id=contract.id) }}" class="rounded-xl border border-slate-700 px-3 py-2 text-xs text-slate-300">Download PDF</a>
      <a href="{{ url_for('service_contract_print', contract_id=contract.id) }}" target="_blank" rel="noopener" class="rounded-xl border border-emerald-500/40 bg-emerald-500/10 px-3 py-2 text-xs font-semibold text-emerald-200">Print</a>
    </div>
  </div>

  <article class="rounded-2xl border border-slate-800 bg-white text-slate-900 p-8 space-y-8">
    <div class="contract-header">{{ header_html|safe }}</div>
    <div class="contract-footer">{{ footer_html|safe }}</div>
    <div class="contract-body space-y-8">
      <section>{{ cover_letter_html|safe }}</section>
      <section>{{ intro_html|safe }}</section>
      <section>{{ spec_html|safe }}</section>
      <section>{{ terms_html|safe }}</section>
      {% if contract.contract_lifts %}
      <section>
        <h2 class="text-lg font-semibold mb-2">Lifts in this contract</h2>
        <div class="space-y-2">
          {% for lift_row in contract.contract_lifts %}
          <div class="rounded border border-slate-300 px-3 py-2 text-sm">
            <div><strong>Identity:</strong> {{ lift_row.lift_identity }}</div>
            <div><strong>Lift Type:</strong> {{ lift_row.lift_type_key }}</div>
            <div><strong>Floors:</strong> {{ lift_row.floors_value }}</div>
            <div><strong>Linked Lift:</strong> {{ lift_row.linked_lift.lift_code if lift_row.linked_lift else '—' }}</div>
          </div>
          {% endfor %}
        </div>
      </section>
      {% endif %}
    </div>
  </article>
</div>
{% endblock %}
